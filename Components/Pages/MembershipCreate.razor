@page "/membership-create"
@rendermode InteractiveServer
@using MyBlazorApp.Data
@using MyBlazorApp.Models
@inject NavigationManager NavigationManager
@inject AppDbContext _context

<PageTitle>Create Membership</PageTitle>

<h3>Create Membership</h3>

<EditForm Model="@membership" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label class="form-label">Name:</label>
        <InputText @bind-Value="membership.Name" class="form-control" />
    </div>

    <div class="mb-3">
        <label class="form-label">Member Type:</label>
        <InputText @bind-Value="membership.MemberType" class="form-control" />
    </div>

    <div class="mb-3">
        <label class="form-label">Phone Number:</label>
        <InputText @bind-Value="membership.PhoneNumber" class="form-control" />
    </div>

    <div class="mb-3">
        <label class="form-label">Date Joined:</label>
        <InputDate @bind-Value="membership.DateJoined" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary">Save</button>
    <a href="/memberships" class="btn btn-secondary">Cancel</a>
</EditForm>

@code {
    private Membership membership { get; set; } = new()
    {
        Name = string.Empty,
        MemberType = string.Empty,
        PhoneNumber = string.Empty,
        DateJoined = DateTime.Now
    };

    private async Task HandleValidSubmit()
    {
        _context.Memberships.Add(membership);
        await _context.SaveChangesAsync();
        NavigationManager.NavigateTo("/memberships");
    }
}